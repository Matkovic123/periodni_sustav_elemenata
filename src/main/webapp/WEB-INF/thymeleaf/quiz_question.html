<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link th:href="@{/resources/static/css/quiz.css}" rel="stylesheet" type="text/css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
<th:block th:replace="fragments/header"/>
<div class="container">
    <div class="vertical-center">
        <div class="panel panel-default">
            <div class="panel-body">
                <h2 th:text="${'Quiz difficulty: ' + questions[0].difficulty}">Quiz difficulty</h2>
                <hr/>
                <form th:action="@{/quiz/results}" id="quizForm" class="form-group" method="POST">
                    <div th:each="question : ${questions}">
                        <div class="row">
                            <div class="col-md-12">
                                <h3 th:text="${question.text}">Question</h3>
                                <ul>
                                    <li th:each="answer : ${answers}">
                                        <div th:if="${answer.question.id == question.id}">
                                            <input type="radio" checked="true" th:name="${question.id}"
                                                   th:id="*{answer.id}" th:value="*{answer.id}">&nbsp;</input>
                                            <label th:for="${answer.id}" th:text="${answer.text}"> label</label>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <hr/>
                    </div>
                    <input id="submit-quiz" type="submit" value="Submit answers" class="btn btn-success"/>
                </form>
            </div>
        </div>
    </div>
</div>

<script>

    function getContextPath() {
        return window.location.pathname.substring(0, window.location.pathname.indexOf("/", 2));
    }


    $("#submit-quiz").click(function (quiz) {

//        quiz.preventDefault();

        var ctx = getContextPath();
        var pathname = window.location.pathname; // Returns path only
        var url      = window.location.href;     // Returns full URL
        console.log(ctx);
        console.log(pathname);
        console.log(url);


        var checkedInputs = $("input:checked");
        var answerIdArray = [];
        checkedInputs.each(function () {
            answerIdArray.push($(this).val());
        })
        console.log(answerIdArray);
        $.ajax({
                type: "POST",
                url: ctx + "/quiz/results",
                data: JSON.stringify(answerIdArray),
                contentType: "application/json",
                dataType: "json"
            }
        )
    });
</script>

</body>
</html>

